
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bubble Risk Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:system-ui;background:#0f172a;color:#e5e7eb;padding:2rem}
h1{text-align:center}
.score{text-align:center;font-size:3rem;font-weight:700; color:#ffffff}
.indicator {
  background: #020617;
  border-radius: 12px;
  padding: 1rem;
}

.indicator h3 {
  margin-bottom: 0.5rem;
}

.bar {
  background: #1e293b;
  border-radius: 6px;
  overflow: hidden;
  height: 14px;
  margin: 0.4rem 0;
  position: relative;
}

.bar-fill {
  height: 100%;
  background: linear-gradient(90deg, #22c55e, #f59e0b, #ef4444);
}

.bar-threshold {
  position: absolute;
  top: 0;
  bottom: 0;
  width: 2px;
  background: #facc15;
  opacity: 0.9;
}

.indicator-meta {
  font-size: 0.85rem;
  opacity: 0.85;
  margin-top: 0.3rem;
}
.score-max {
  opacity: 0.6;
  font-size: 0.6em;
}
  #indicators {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: 1rem;
  margin-top: 2rem;
}
.green{color:#22c55e}.orange{color:#f59e0b}.red{color:#ef4444}
.updated{opacity:.7;margin-top:1rem;text-align:right}
.brief{background:#020617;border-left:4px solid #f59e0b;padding:1rem;margin-top:1.5rem}
</style>
</head>
<body>
<h1>Bubble Risk Dashboard</h1>
<div class="score">
  <span id="scoreValue">--</span><span class="score-max"> / 100</span>
</div>
  <div id="distance" class="distance"></div>
  <div id="level" class="level"></div>
  <div id="brief" class="brief"></div>
  <div class="change-summary">
  Today’s Change: <strong id="changeSummary"></strong>
</div>
<div id="indicators" class="indicator-grid"></div>
<div id="updated" class="updated"></div>
<script>
fetch("data.json")
  .then(res => res.json())
  .then(data => {
    // Core fields
    document.getElementById("updated").textContent = `Data as of ${data.date}`;
    document.getElementById("scoreValue").textContent = data.score;

    document.getElementById("level").textContent = data.level;
    document.getElementById("brief").textContent = data.brief;

    // Distance to extreme risk (DEFINE FIRST)
    const EXTREME_THRESHOLD = 75;
    const distance = Math.max(0, EXTREME_THRESHOLD - data.score);
    document.getElementById("distance").textContent =
      `${distance} points from Extreme Risk`;

    // Today's change
    document.getElementById("changeSummary").textContent =
      data.changeSummary || "No change data available.";

    // Indicators
    const container = document.getElementById("indicators");
    container.innerHTML = "";

    if (!Array.isArray(data.indicators)) {
      container.innerHTML = "<p>No indicators available.</p>";
      return;
    }

    data.indicators.forEach(indicator => {
  const div = document.createElement("div");
  div.className = "indicator";

  const value = indicator.value ?? 0;
  const threshold = indicator.threshold ?? 100;

  div.innerHTML = `
    <h3>${indicator.name}</h3>

    <div class="bar">
      <div class="bar-fill" style="width:${value}%;"></div>
      <div class="bar-threshold" style="left:${threshold}%;"></div>
    </div>

    <div class="indicator-meta">
      ${value} / 100 <br>
      ⚠ <strong>${indicator.status}</strong> (threshold: ${threshold})
    </div>

    <p>${indicator.description}</p>
  `;

  container.appendChild(div);
});

  .catch(err => {
    console.error("Dashboard load error:", err);
  });
</script>


</body>
</html>
